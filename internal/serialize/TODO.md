TODO:
 * Need stricter checking of overflow
 * Need a verifier to make sure things don't step on each other
 * Using unmarshal/marshal by reflection is probably not the most performant thing